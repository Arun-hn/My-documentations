#Creation of EC2, SG along with User Data with Private VPC using Cloud Formation 
#EC2 Key Pair
Parameters:
KeyName:     
Description: Name of an existing EC2 KeyPair to enable SSH access to the ECS instances     Type: AWS::EC2::KeyPair::KeyName     ConstraintDescription: must be the name of new EC2 KeyPair. #Creation of EC2 instance with User Data   Resources:    EC2Instance:     Type: AWS::EC2::Instance     Properties:       ImageId: ami-03ededff12e34e59e      InstanceType: t2.micro      KeyName: !Ref KeyName      AvailabilityZone: us-east-1c UserData:Fn::Base64: !Sub|            #!/bin/bash            sudo yum update -y            sudo yum install -y httpd.x86_64            sudo systemctl start httpd.service            sudo systemctl enable httpd.service      echo Hello Wissenites! @ SRIHARI @ > /var/www/html/index.html     Tags:       - Key: Name         Value: DTP      SecurityGroupIds:        - !Ref InstanceSecurityGroup       SubnetId: !Ref Subnet1 #Creation of Security Groups TCP and All traffic         InstanceSecurityGroup:     Type: AWS::EC2::SecurityGroup     Properties:       GroupDescription: Enable SSH access via port 22      VpcId: !Ref VPC      SecurityGroupIngress:       - IpProtocol: tcp         FromPort: 22         ToPort: 22         CidrIp: 0.0.0.0/0       - IpProtocol: tcp         FromPort: 0 
#Creation of EC2, SG along with User Data with Private VPC using         Cloud Formation         ToPort: 65535         CidrIp: 0.0.0.0/0      SecurityGroupEgress:       - IpProtocol: tcp         FromPort: 22         ToPort: 22         CidrIp: 0.0.0.0/0       - IpProtocol: tcp         FromPort: 0         ToPort: 65535         CidrIp: 0.0.0.0/0 #Creation of EIP    ElasticIp:     Type: AWS::EC2::EIP     Properties:      Domain: VPC      InstanceId: !Ref EC2Instance #Creation of VPC    VPC:     Type: AWS::EC2::VPC     Properties:      CidrBlock: 10.0.0.0/16      Tags:        - Key: Name         Value: MyVPC #Creation of Public Subnet    Subnet1:     Type: AWS::EC2::Subnet     Properties:      AvailabilityZone: us-east-1c      VpcId: !Ref VPC      CidrBlock: 10.0.0.0/24      Tags:       - Key: Name         Value: MySubnet1 
#Creation of EC2, SG along with User Data with Private VPC using         Cloud Formation #Creation of Route Table    MyRouteTable:     Type: AWS::EC2::RouteTable     Properties:       Tags:        - Key: Name         Value: TestVpc2RoutTable      VpcId: !Ref VPC #Creation of Routes     MyRoutes:     Type: AWS::EC2::Route     Properties:      RouteTableId: !Ref MyRouteTable      DestinationCidrBlock: 0.0.0.0/0      GatewayId: !Ref MyInternetGateway #Creation of IGW    MyInternetGateway:        Type: AWS::EC2::InternetGateway     Properties:       Tags:       - Key: Name         Value: TestVpc2IGW  #GW attachment to the VPC    VpcGatewayAttachment:       Type: AWS::EC2::VPCGatewayAttachment     Properties:        InternetGatewayId: !Ref MyInternetGateway       VpcId: !Ref VPC #Subnet Association      SubnetRouteTableAssociation:     Type: AWS::EC2::SubnetRouteTableAssociation     Properties:       RouteTableId: !Ref MyRouteTable       SubnetId: !Ref Subnet1